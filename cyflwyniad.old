

  

  # Some states have cleanup that should happen if we terminate in them.  An
  # None entry in the table means that terminating here is OK, but there's
  # nothing to do.
  cleanup = {
    S.config : None,
    S.style : None,
    S.script : None,
    S.in_slide : end_slide,
  }

  try:
    cleanup_func = cleanup[state]
  except KeyError:
    complain('Did not expect end-of-file in %s state.' % (state))
  if cleanup_func:
    cleanup_func()
  
  if tag_stack:
    tag, token = tag_stack.pop()
    token.complain("Unclosed %s tag." % tag)

